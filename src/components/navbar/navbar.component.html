<nav class="bg-white dark:bg-dark-surface shadow-lg">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-20">
      <!-- Logo/Title Section -->
      <div class="flex items-center space-x-4">
        <div class="flex items-center justify-center">
          <img
            src="assets/qulogo.png"
            alt="School AI Logo"
            class="h-12 w-auto"
          />
        </div>
        <!-- <div>
        <h2
          class="text-xl font-bold text-gray-900 dark:text-white leading-none"
        >
          School AI
        </h2>
        <p class="text-sm text-gray-600 dark:text-gray-300">
          Intelligent School Management
        </p>
      </div> -->
      </div>

      <!-- Navigation Menu -->
      <div class="flex items-center space-x-4">
        @for (item of menuItems; track item.id) {
          <div class="relative group">
            <div class="flex flex-col">
              @if (item.children) {
                <!-- Parent item with dropdown -->
                <div
                  class="flex items-center p-2 rounded-lg cursor-pointer transition hover:bg-gray-50 dark:hover:bg-dark-bg"
                  (click)="toggleExpand(item)"
                >
                  <div class="flex items-center">
                    <div class="flex items-center min-w-[2.5rem]">
                      <i
                        [class]="item.icon | icon"
                        class="text-2xl text-gray-600 dark:text-gray-300 transition-all duration-500 ease-out group-hover:text-primary dark:group-hover:text-accent-yellow group-hover:scale-110"
                      ></i>
                    </div>
                    <span
                      class="pl-1 text-gray-700 dark:text-gray-200 max-w-0 overflow-hidden transition-all duration-500 ease-out group-hover:max-w-[160px]"
                    >
                      {{ item.label }}
                    </span>
                  </div>
                </div>

                <!-- Dropdown Menu -->
                <div
                  class="absolute top-full right-0 mt-2 w-48 bg-white dark:bg-dark-surface rounded-md shadow-lg transition-all duration-200 origin-top-right transform"
                  [class.dropdown-open]="item.expanded"
                >
                  @for (child of item.children; track child.id) {
                    <a
                      [routerLink]="child.route"
                      class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-dark-bg"
                      [ngClass]="
                        isActiveRoute(child.route)
                          ? 'bg-primary/10 text-primary dark:bg-dark-bg dark:text-accent-yellow'
                          : ''
                      "
                    >
                      <i [class]="child.icon | icon" class="mr-3"></i>
                      <span>{{ child.label }}</span>
                    </a>
                  }
                </div>
              } @else {
                <!-- Single item -->
                <a
                  [routerLink]="item.route"
                  class="flex items-center p-2 rounded-lg transition hover:bg-gray-50 dark:hover:bg-dark-bg"
                >
                  <div class="flex items-center">
                    <div class="flex items-center min-w-[2.5rem]">
                      <i
                        [class]="item.icon | icon"
                        class="text-2xl transition-all duration-500 ease-out"
                        [class.text-primary]="isActiveRoute(item.route)"
                        [class.dark:text-accent-yellow]="
                          isActiveRoute(item.route)
                        "
                        [class.text-gray-600]="!isActiveRoute(item.route)"
                        [class.dark:text-gray-300]="!isActiveRoute(item.route)"
                        [class.scale-110]="isActiveRoute(item.route)"
                      ></i>
                    </div>
                    <span
                      class="pl-1 text-gray-700 dark:text-gray-200 overflow-hidden transition-all duration-500 ease-in-out whitespace-nowrap"
                      [class.max-w-0]="!isActiveRoute(item.route)"
                      [class.max-w-[160px]]="isActiveRoute(item.route)"
                      [class.group-hover:max-w-[160px]]="
                        !isActiveRoute(item.route)
                      "
                      [class.text-primary]="isActiveRoute(item.route)"
                      [class.dark:text-accent-yellow]="
                        isActiveRoute(item.route)
                      "
                      [class.opacity-0]="!isActiveRoute(item.route)"
                      [class.opacity-100]="isActiveRoute(item.route)"
                      [class.group-hover:opacity-100]="
                        !isActiveRoute(item.route)
                      "
                    >
                      {{ item.label }}
                    </span>
                  </div>
                </a>
              }
            </div>
          </div>
        }
        <button
          (click)="openProfileDialog()"
          class="flex items-center px-3 py-1 rounded-2xl bg-gray-100 hover:bg-gray-50 dark:hover:bg-dark-bg"
        >
          <div class="flex items-center">
            <div class="flex items-center">
              <i
                [class]="'USER' | icon"
                class="text-2xl transition-all duration-500 text-gray-700 dark:text-accent-yellow"
              ></i>
            </div>
          </div>
        </button>

        <button
          (click)="logout()"
          class="flex items-center gap-2 px-4 py-2 rounded-lg text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-dark-bg hover:bg-gray-200 dark:hover:bg-dark-surface hover:text-gray-600 dark:hover:text-white transition"
        >
          <i [class]="'LOGOUT' | icon" class="text-xl"></i>
          <span class="font-medium">Logout</span>
        </button>
        <!-- <div class="flex items-center gap-4">
        <button
          (click)="toggleTheme()"
          class="p-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-dark-bg transition"
          aria-label="Toggle theme"
        >
          <i
            [class]="(isDarkMode ? 'SUN' : 'MOON') | icon"
            class="text-xl"
          ></i>
        </button>
      </div> -->
      </div>
    </div>
  </div>
</nav>
